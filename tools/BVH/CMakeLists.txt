# Include this directory
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})

# Enumerate source files
FILE(GLOB SRC_FILES *.cpp *.inl)
FILE(GLOB INC_FILES *.h)

SET(DEPENDENT_LIBS "")
SET(DEPENDENT_INCLUDES "")

# CGAL
IF (CGAL_FOUND)
    ADD_DEFINITIONS(-DWITH_CGAL)
    LIST(APPEND DEPENDENT_LIBS cgal_wrapper)
    ADD_SUBDIRECTORY(CGAL)
ELSE (CGAL_FOUND)
    MESSAGE(WARNING "CGAL is missing, CGAL boolean support is skipped")
ENDIF (CGAL_FOUND)

# GeoGram
IF (GEOGRAM_FOUND)
    LIST(APPEND DEPENDENT_INCLUDES ${GEOGRAM_INCLUDE_DIR})
    LIST(APPEND DEPENDENT_LIBS geogram_base)
    ADD_DEFINITIONS(-DWITH_GEOGRAM)
    ADD_SUBDIRECTORY(Geogram)
ENDIF (GEOGRAM_FOUND)

ADD_LIBRARY(lib_bvh SHARED ${SRC_FILES} ${INC_FILES})
SET_TARGET_PROPERTIES(lib_bvh PROPERTIES OUTPUT_NAME "bvh")
TARGET_INCLUDE_DIRECTORIES(lib_bvh SYSTEM PRIVATE ${DEPENDENT_INCLUDES})
TARGET_LINK_LIBRARIES(lib_bvh Mesh ${DEPENDENT_LIBS})

ADD_CUSTOM_TARGET(bvh DEPENDS lib_bvh)
